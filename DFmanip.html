<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Get started with R - 3/3</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">GEOG 2015 - Introduction to GIS and statistics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/BenCretois/GEOG2015">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Get started with R - 3/3</h1>

</div>


<p>This lesson is the last of this small introduction to R! Here there will be even more practice as we will be manipulating a real dataset and you will learn some of the basic functions to inspect a dataset! For this lesson I expext you to get a good understanding of what a data frame is :)</p>
<p>You will learn:</p>
<ul>
<li>Load CSV data</li>
<li>Inspect the basic properties of a data frame such as its size, class and type of data it contains</li>
<li>Generate summary statistics for a dataframe</li>
<li>Use indexing to select rows and columns</li>
<li>Add columns and rows to the data frame</li>
</ul>
<div id="loading-the-data-frame" class="section level1">
<h1><span class="header-section-number">1</span> Loading the data frame</h1>
<p>R can read a wide range of data format including xlsx documents (your excell spreadsheet). One of the most common format is the XLS file. It is basically the excell document.</p>
<p>First, you will download the dataset available on blackboard: <code>worldbank_df.xls</code>. Save it in the relevant folder (remember the first lesson). For instance my main folder is GEOG2015 and I save in the subfolder <code>data</code>:</p>
<pre class="r"><code>knitr::include_graphics(&#39;imgs_tuto/setwd.PNG&#39;)</code></pre>
<p><img src="imgs_tuto/setwd.PNG" width="449" /></p>
<p>Now that your csv file is saved in the right folder you are almost ready to read the file! Remember the first lesson about projects and working directories? If not read the section again because it is important at this very moment!</p>
<p>If you have made a R project (as you should have) the working directory is already set and you just need to load your data.</p>
<p>Otherwise you need to set the working directory with setwd. To do so click right on <code>WorldView.csv &gt; properties &gt; copy paste the location in setwd()</code> as follow:</p>
<pre class="r"><code>setwd(&quot;PATH/THAT/IS/WRITTEN&quot;)</code></pre>
<p>Make sure you replace  (that R do not understand) by /!</p>
<p>Now is time to open your data! For that we need to use the function <code>read.xlsx()</code> from the library xlsx. First you need to install the library <code>xlsx</code>:</p>
<pre class="r"><code>install.packages(&#39;xlsx&#39;)</code></pre>
<p>And then load the library:</p>
<pre class="r"><code>library(xlsx)</code></pre>
<p>Now you can open your document with the function described above.</p>
<p>If you are in the project write:</p>
<pre class="r"><code>data &lt;- read.xlsx(&quot;data/worldbank_df.xlsx&quot;, sheetIndex = 1)</code></pre>
<p>If you are not in a project write (with your own path):</p>
<pre class="r"><code>setwd(&#39;//home.ansatt.ntnu.no/benjamcr/Desktop/Teaching/GEOG2015&#39;)
data &lt;- read.xlsx(&#39;data/worldbank_df.xlsx&#39;, sheetIndex = 1)</code></pre>
<p>Now, this line of code doesn’t produce any output in the console because, as you might recall, <strong>assignments don’t display anything</strong>. If we want to check that our data has been loaded, we can print the variable’s value by running data. If you do that you have your whole dataset printed in your console! That is not very handy and we need to find other strategies to inspect the data frame reasonably . . . We can for instance use the function head() to inspect the firsts 6 lines:</p>
<pre class="r"><code>head(data)</code></pre>
<pre><code>##   NA.                 name iso_a2   HDI urban_pop unemployment pop_growth
## 1   1          Afghanistan     AF    NA   8609463           NA  3.1832015
## 2   2               Angola     AO 0.504  11649562           NA  3.4854125
## 3   3              Albania     AL    NA   1629715        17.49 -0.2070470
## 4   4 United Arab Emirates     AE    NA   7734365           NA  0.7147625
## 5   5            Argentina     AR    NA  39372787         7.27  1.0327093
## 6   6              Armenia     AM    NA   1825455        17.50  0.4383315
##   literacy
## 1       NA
## 2 66.03011
## 3       NA
## 4       NA
## 5       NA
## 6       NA</code></pre>
<p>Much better! Like this we get a good overview of the dataset without being overwhelmed by too much data!</p>
</div>
<div id="a-bit-more-about-our-training-dataset" class="section level1">
<h1><span class="header-section-number">2</span> A bit more about our training dataset</h1>
<p>The dataset is composed of 7 columns:</p>
<ul>
<li>name: name of the countries present in the dataset</li>
<li>iso_a2: a 2 letter code identifying the country</li>
<li>HDI: the Human Development Index</li>
<li>urban_pop: Urban population number within the countries</li>
<li>unemployment: unemployment rate</li>
<li>pop_growth: growth rate of the population within the country</li>
<li>literacy: the percentage of population which is litterate</li>
</ul>
</div>
<div id="inspecting-dataframe-objects" class="section level1">
<h1><span class="header-section-number">3</span> Inspecting dataframe objects</h1>
<p>Remember how we defined a data frame in the previous lesson? Okay just a quick reminder: a data frame is a <strong>representation of data where the columns are vectors that all have the same length</strong>. Because the columns are vectors, they all contain the same type of data (e.g. numeric, characters). But the type of data can vary BETWEEN vectors!</p>
<p>You can inspect the structure of a data frame with the function str():</p>
<pre class="r"><code>str(data)</code></pre>
<pre><code>## &#39;data.frame&#39;:    177 obs. of  8 variables:
##  $ NA.         : Factor w/ 177 levels &quot;1&quot;,&quot;10&quot;,&quot;100&quot;,..: 1 90 101 112 123 134 145 156 167 2 ...
##  $ name        : Factor w/ 177 levels &quot;Afghanistan&quot;,..: 1 4 2 166 6 7 5 56 8 9 ...
##  $ iso_a2      : Factor w/ 174 levels &quot;AE&quot;,&quot;AF&quot;,&quot;AL&quot;,..: 2 5 3 1 7 4 6 152 9 8 ...
##  $ HDI         : num  NA 0.504 NA NA NA NA NA NA NA NA ...
##  $ urban_pop   : num  8609463 11649562 1629715 7734365 39372787 ...
##  $ unemployment: num  NA NA 17.49 NA 7.27 ...
##  $ pop_growth  : num  3.183 3.485 -0.207 0.715 1.033 ...
##  $ literacy    : num  NA 66 NA NA NA ...</code></pre>
<p>As you can see, the column <code>name</code> is a factor (we will se what is a factor a bit later in this lesson) while <code>urban_pop</code> is numeric, does that make sense?</p>
<p>So we already learned how to use str() and head() but there is much much more functions to inspect a dataframe! I would like you to play around with them! :)</p>
<p>To inspect size:</p>
<ul>
<li>dim()</li>
<li>nrow()</li>
<li>ncol()</li>
<li>length()</li>
</ul>
<p>To inspect names of rows and columns:</p>
<ul>
<li>colnames()</li>
<li>rownames()</li>
</ul>
<p>To summarize the data frame:</p>
<ul>
<li>summary()</li>
<li>str()</li>
</ul>
<p>Now this is a non-exhaustive list and there is more! However in my experience these are the most useful you need to know!</p>
<p>Small exercise: play with the functions and try to figure out what they do exactly! You can use the help from R ?</p>
</div>
<div id="indexing-and-subsetting-dataframes" class="section level1">
<h1><span class="header-section-number">4</span> Indexing and subsetting dataframes</h1>
<p>The <code>worldbank_df</code> dataset has two dimensions (rows and columns) and if we want to extract some specific information from it we need to specify the coordinates we want from it. It is like subsetting a matrix (remember the previous lesson!): rows come first and it is followed by column number:</p>
<pre class="r"><code>data[ 1 , 1 ] #First element in the first column
data[ 1 , 3 ] #First element in the third column
data[ , 1 ] #First column
data[ 4 , ] #Fourth row
data[ 1:10 , 1 ] #Rows 1 to 10 from the first column
#And so forth and so on ... Just try to play with that!</code></pre>
<p>You can also subset the columns of a data frame using their names:</p>
<pre class="r"><code>data[ , &quot;name&quot; ] # I subset the column name -&gt; the result will be a vector!
data[ , c(&quot;name&quot;, &quot;unemployment&quot;) ] # I subset the columns name and unemployment -&gt; #the result will be a dataframe</code></pre>
<p>Another way for subsetting columns of a data frame is using <code>$</code></p>
<pre class="r"><code>data$name # It is equivalent to data[ , &quot;name&quot; ]</code></pre>
<p>Exercise: create a data frame <code>country_pop</code> by subsetting <code>name</code>, <code>urban_pop</code> and <code>pop_growth</code>. Inspect this new dataframe using the functions we learned.</p>
</div>
<div id="conditional-subsetting" class="section level1">
<h1><span class="header-section-number">5</span> Conditional subsetting</h1>
<p>Often, we need to extract a subset of a data frame based on certain conditions. For instance, if I want to have a look at some specific countries . . . let’s say Norway:</p>
<pre class="r"><code>data[data$name == &quot;Norway&quot; , ] # This line of code tells R to subset the row in which &quot;name&quot; equal Norway</code></pre>
<p>Now if I want to create a new dataset by subsetting only France and Norway I would do like this:</p>
<pre class="r"><code>NOR_FRA &lt;- data[data$name == &quot;Norway&quot; | data$name == &quot;France&quot;, ]
NOR_FRA</code></pre>
<pre><code>##     NA.   name iso_a2 HDI urban_pop unemployment pop_growth literacy
## 56   56 France     FR  NA  52593947        10.30  0.5038689       NA
## 119 119 Norway     NO  NA   4120471         3.48  1.1277367       NA</code></pre>
<p>I must admit there is a much simpler way but this require a bit more knowledge about R. However doing as describe above will give you a better understanding of how the R structures work. For those who are intereseted have a look at the function <code>filter()</code> from the <code>dplyr</code> package.</p>
</div>
<div id="adding-and-removing-rows-and-columns" class="section level1">
<h1><span class="header-section-number">6</span> Adding and removing rows and columns</h1>
<p>I can add columns to a data frame using the cbind() function. For instance, let’s say I want to create a column “ID” which assigns a number to each country. I first create the vector and add it to the dataframe:</p>
<pre class="r"><code>ID &lt;- 1:nrow(data) #A vector going from 1 to 160 (which is the length of my data frame)
cbind(data, ID)</code></pre>
<p>To add rows to a data frame we need to use the function <code>rbind()</code>.</p>
</div>
<div id="categorical-data-factors" class="section level1">
<h1><span class="header-section-number">7</span> Categorical data: factors</h1>
<p>Remember when I told you that in R there is more data type than only numeric and character? Well factor is another important type of data and deserve a section on its own!</p>
<p>When we did str(data) we saw that <code>name</code> was a factor right? Well, factors are very useful and are actually something that make R particularly well suited to working with data, so we’re going to spend a little time introducing them.</p>
<p>Factors are used to represent <code>categorical data</code>. Factors can be ordered or unordered, and understanding them is necessary for statistical analysis and for plotting.</p>
<p>Factors are stored as integers, and have labels (text) associated with these unique integers. While factors look (and often behave) like character vectors, <code>they are actually integers under the hood</code>, and you need to be careful when treating them like strings.</p>
<p>Once created, factors can only contain a pre-defined set of values, known as levels. By default, R always sorts levels in alphabetical order. For instance, if you have a factor with 2 levels:</p>
<pre class="r"><code>sex &lt;- factor(c(&quot;man&quot;, &quot;woman&quot;, &quot;woman&quot;, &quot;man&quot;, &quot;woman&quot;))</code></pre>
<p>R will assign the value of 1 to the level man and the value 2 to the level woman. You can check this by using the functions <code>levels()</code> and <code>nlevels()</code>.</p>
<pre class="r"><code>levels(sex)</code></pre>
<pre><code>## [1] &quot;man&quot;   &quot;woman&quot;</code></pre>
<pre class="r"><code>nlevels(sex)</code></pre>
<pre><code>## [1] 2</code></pre>
<p>Sometimes the order of the factors do not matter (here that would be the same if the level <code>woman</code> has the value 1 but there is some cases when it is meaningful: a value of 1 for “low”, 2 for “moderate” and 3 for “high” would make sense.</p>
<div id="reordering-levels" class="section level2">
<h2><span class="header-section-number">7.1</span> Reordering levels</h2>
<p>It is possible to reorder the levels of a vector:</p>
<pre class="r"><code>sex #gives the current order of the levels</code></pre>
<pre><code>## [1] man   woman woman man   woman
## Levels: man woman</code></pre>
<pre class="r"><code>sex &lt;- factor(sex, levels = c(&#39;woman&#39;,&#39;man&#39;)) # I reorder
sex # after re ordering</code></pre>
<pre><code>## [1] man   woman woman man   woman
## Levels: woman man</code></pre>
</div>
<div id="converting-factors" class="section level2">
<h2><span class="header-section-number">7.2</span> Converting factors</h2>
<p>Sometimes, R open that dataframe and thinks one of the column is a factor while in reality it is not (such as it is the case for <code>name</code> here). In these cases we need to convert the data type</p>
<p>If you need to convert a factor vector to a character vector use the function <code>as.character()</code></p>
<pre class="r"><code>as.character(data$name)</code></pre>
<p>If you need to convert factors where the levels appear as numbers (such as dates) to a numeric vector you need to first convert factors to character and then numbers:</p>
<pre class="r"><code>dates &lt;- factor(c(1500,1600,1700,1800,1900,2000))
as.numeric(as.character(dates)) #Looks a bit complicated but works well</code></pre>
<pre><code>## [1] 1500 1600 1700 1800 1900 2000</code></pre>
</div>
</div>
<div id="some-questions" class="section level1">
<h1><span class="header-section-number">8</span> Some questions!</h1>
<p>As usual you have a task to complete! This task may take a bit more time and research but I am sure you are able to complete it :)</p>
<p>We discovered a new country whom name is “Wakanda”! Using all your previous knowledge add a new row to the data frame. the <code>iso_a2</code> code for Wakanda is “WA” and you can choose the other values (you can choose to make Wakanda a very litterate country or not for instance)</p>
</div>
<div id="end-of-the-tutorial" class="section level1">
<h1><span class="header-section-number">9</span> End of the tutorial</h1>
<p>You made it until the end of this -short- tutorial about R! While I tried to be concise keep in mind that R is much much more than what you learned! However, this tutorial will give you the basics to handle to most common data structures that you will find.</p>
<p>In the exercises we will learn much more things, and especially how to turn R into a GIS software!</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
